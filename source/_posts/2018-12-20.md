---
title: react 高阶组件实现弹窗交互
date: 2018-12-20
tags: [react, 高阶组件]
---

项目中使用了多个弹窗组件, 并且框架样式复用, 所以考虑到用高阶组件统一做处理.

## 设计

> 弹窗包含浮层及内容显示框架, 需有移除 dom 的能力.

> 所有被包装组件, props 统一携带 onClose 方法, 用于关闭弹窗及触发回调.

## 代码实现
**withModal.js**
```js
function getDisplayName(WrappedComponent) {
    return WrappedComponent.displayName || WrappedComponent.name || "Component"
}

/**
 * 弹窗高阶组件
 * @param {component} WrappedComponent
 */
export default function withModal(WrappedComponent) {
    return function WithModal({onClose, ...props}) {
        WithModal.displayName = `WithModal(${getDisplayName(WrappedComponent)})`
        return (
            <>
                <div className="modal-my">
                    <div className="modal-content-my">
                        <WrappedComponent {...props} onClose={onClose} />
                        <span onClick={onClose} className="modal-close-my">
                            <span>&times;</span>
                        </span>
                    </div>
                </div>
            </>
        )
    }
}
```

## 使用示例

**shareFileModal.js**
```js
import React, { Component } from "react"
import PropTypes from "prop-types"

import { withModal } from "com/modal"

const props = {
    onClose: PropTypes.func.isRequired,
}

@withModal
class ShareFileModal extends Component {
    // ...
}
```
