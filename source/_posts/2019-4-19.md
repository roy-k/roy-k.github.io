---
title: mockjs 扼要
date: 2019-04-19 14:25:15
tags:  mockjs
---

## 模块引入

> 入口文件引入 mock 模块即可
```
src
    mock
        index.js
        modules
```

## 语法

### 拦截

```
Mock.mock(rurl, type, templage|function({url, type, body}))
```

> get 带参数时, 需要用正则匹配url

```js
Mock.mock(RegExp(path + '.*'), 'get', (params) => {})
```

### 模板语法

[数据模板](https://github.com/nuysoft/Mock/wiki/Syntax-Specification#%E6%95%B0%E6%8D%AE%E6%A8%A1%E6%9D%BF%E5%AE%9A%E4%B9%89%E8%A7%84%E8%8C%83-dtd)

数据模板中的每个属性由 3 部分构成：属性名、生成规则、属性值：

```
'name|rule': value
```

- 'name|count': value
- 'name|min-max': value
- 'name|+step': value
- 'name': @占位符

```js
Mock.mock({
    'list|10': {
        'id|+1': 1,
        'age|12-28': 1,
        'status|0-2': 1,
    }
})
```

[占位符](https://github.com/nuysoft/Mock/wiki/Mock.Random)

> Mock.Random 提供的完整方法（占位符）如下:

| Type | Method|
| ------ | ------ |
| Basic	| boolean, natural, integer, float, character, string, range, date, time, datetime, now |
| Image	| image, dataImage |
| Color	| color |
| Text	| paragraph, sentence, word, title, cparagraph, csentence, cword, ctitle |
| Name	| first, last, name, cfirst, clast, cname |
| Web	| url, domain, email, ip, tld |
| Address	| area, region |
| Helper	| capitalize, upper, lower, pick, shuffle |
| Miscellaneous	| guid, id |

```js
Mock.mock({
    name: '@cname',
    text: '@ctitle',
})
```

### 编程式用法

```ts
import Mockfrom 'mockjs'
import qs from 'query-string'

Mock.mock(RegExp('api/list' + '.*'), 'get', (params: any) => {
    const paramsString = params.url.split('?')[1]

    const { page: current } = qs.parse(paramsString)

    const total = 46
    const listLength: number = total > 10 * Number(current) ? 10 : 10 + (total - 10 * Number(current))

    return {
        total,
        current,
        list: new Array(listLength).fill(current).map((v, i) => {
            return Mock.mock({
                id: Number(current) * 10 - 10 + i + 1,
                name: '@cname',
                'age|12-28': 1,
                'status|0-2': 1,
                text: '@ctitle',
            })
        }),
    }
})
```