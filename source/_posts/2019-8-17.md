---
title: create react app 文档细节
date: 2019-08-17 10:07:30
tags: [react]
categories: [react]
---

整理使用 CRA 创建项目的一些调整, 及文档内容提炼

## 初始化

1. 添加typescript

    `yarn create react-app my-app --typescript`

## 自定义配置

> yarn run eject 展开详细配置

1. 支持less

```shell
yarn add less less-loader
```
```js
// webpack.config.js

const sassModuleRegex = /\.module\.(scss|sass)$/
// 照着sass 写
const lessRegex = /\.(less)$/
const lessModuleRegex = /\.module\.(less)$/

// rules 照着sass改
{
    test: lessRegex,
    exclude: lessModuleRegex,
    use: getStyleLoaders(
        {
            importLoaders: 2,
            sourceMap: isEnvProduction && shouldUseSourceMap,
        },
        "less-loader"
    ),
    sideEffects: true,
},
{
    test: lessModuleRegex,
    use: getStyleLoaders(
        {
            importLoaders: 2,
            sourceMap: isEnvProduction && shouldUseSourceMap,
            modules: true,
            getLocalIdent: getCSSModuleLocalIdent,
        },
        "less-loader"
    ),
},
```

2. 自动加载react 无需到处引入

```js
// webpack.config.js
// plugins
new webpack.ProvidePlugin({
    React: 'react',
}),
```

3. lint 提交自动格式化

4. storybook 组件文档

5. 开发代理

```js
// src/setupProxy.js
module.exports = function(app) {
  app.use(proxy('/api', { target: 'http://localhost:5000/' }));
  app.use(proxy('/websocket', { target: 'http://localhost:5000/', ws: true }));
};
```

## 部署

1. 资源路径

    待细化

2. 兼容性调整

```shell
yarn add react-app-polyfill
```
```js
// index.js
import 'react-app-polyfill/ie9';
// or
import 'react-app-polyfill/ie11';

import 'react-app-polyfill/stable';
```
> 或 `corejs` 应该也可以, 按需引入
